package com.demo.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import com.demo.beans.Employee;

public class EmpDaoImpl implements EmpDao {
	static Connection conn;
	static PreparedStatement insPst;
	
	static {
		try {
			conn=HBUtils.getConnection();
			insPst=conn.prepareStatement("insert into emp values(?,?,?,?)");
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}
	@Override
	public boolean addEmp(Employee emp){
		try {
			insPst.setInt(1, emp.getEid());
			insPst.setString(2, emp.getEname());
			insPst.setDouble(3, emp.getSal());
			insPst.setDate(4, java.sql.Date.valueOf(emp.getHireDate()));
			int rowsUpdated = insPst.executeUpdate();
			return rowsUpdated>0;
		} catch (SQLException e) {
			e.printStackTrace();
		}
	}

}
